MWF.xApplication.cms.ColumnManager=MWF.xApplication.cms.ColumnManager||{};MWF.xApplication.cms.ColumnManager.Actions=MWF.xApplication.cms.ColumnManager.Actions||{};MWF.xDesktop.requireApp("cms.ColumnManager","package",null,false);MWF.require("MWF.xDesktop.Actions.RestActions",null,false);MWF.require("MWF.widget.UUID",null,false);MWF.xApplication.cms.ColumnManager.Actions.RestActions=new Class({initialize:function(){this.action=new MWF.xDesktop.Actions.RestActions("/Actions/action.json","x_cms_assemble_control","x_component_cms_ColumnManager");this.actionProcess=new MWF.xDesktop.Actions.RestActions("/Actions/action.json","x_processplatform_assemble_designer","x_component_cms_ColumnManager")},getId:function(e,a,i,n){this.action.invoke({name:"getId",async:n,parameter:{count:e},success:a,failure:i})},getUUID:function(a){var i="";this.action.invoke({name:"getId",async:false,parameter:{count:"1"},success:function(e){i=e.data[0];if(a)a(i)},failure:null});return i},listColumn:function(e,a,i){this.action.invoke({name:"listColumn",async:i,success:e,failure:a})},listColumnByPublish:function(e,a,i){this.action.invoke({name:"listColumnByPublish",async:i,success:e,failure:a})},listColumnByAdmin:function(e,a,i){this.action.invoke({name:"listColumnByAdmin",async:i,success:e,failure:a})},getColumn:function(e,a,i){this.action.invoke({name:"getColumn",parameter:{id:e.id},success:a,failure:i})},saveColumn:function(e,a,i){if(!e.isNewColumn){this.updateColumn(e,a,i)}else{this.addColumn(e,a,i)}},addColumn:function(e,a,i){this.action.invoke({name:"addColumn",data:e,success:a,failure:i})},updateColumn:function(e,a,i){this.action.invoke({name:"updateColumn",data:e,parameter:{id:e.id},success:a,failure:i})},removeColumn:function(e,a,i,n){this.action.invoke({name:"removeColumn",async:n,parameter:{id:e},success:a,failure:i})},getColumnIcon:function(e,a,i){this.action.invoke({name:"getColumnIcon",parameter:{id:e},success:a,failure:i})},updataColumnIcon:function(e,a,i,n,t){this.action.invoke({name:"updataColumnIcon",parameter:{id:e},data:n,file:t,success:a,failure:i})},listAllCategory:function(e,a,i){this.action.invoke({name:"listAllCategory",async:i,success:e,failure:a})},listCategory:function(e,a,i,n){var t=this;this.action.invoke({name:"listCategory",parameter:{appId:e},async:n,success:function(e){t.transCategoryData(e);a.call(this,e)},failure:i})},listCategoryByPublisher:function(e,a,i,n){var t=this;this.action.invoke({name:"listCategoryByPublisher",parameter:{appId:e},async:n,success:function(e){t.transCategoryData(e);a.call(this,e)},failure:i})},getCategory:function(e,a,i){var n=this;this.action.invoke({name:"getCategory",parameter:{id:e},success:function(e){n.transCategoryData(e);a.call(this,e)},failure:i})},saveCategory:function(e,a,i){if(!e.isNew){this.updateCategory(e,a,i)}else{this.addCategory(e,a,i)}},addCategory:function(e,a,i){this.action.invoke({name:"addCategory",data:e,success:a,failure:i})},updateCategory:function(e,a,i){this.action.invoke({name:"updateCategory",data:e,parameter:{id:e.id},success:a,failure:i})},removeCategory:function(e,a,i,n){this.action.invoke({name:"removeCategory",async:n,parameter:{id:e},success:a,failure:i})},transCategoryData:function(e){var a=function(e){if(!e.name)e.name=e.categoryName;if(!e.alias)e.alias=e.categoryAlias;if(!e.categoryName)e.categoryName=e.name;if(!e.categoryAlias)e.categoryAlias=e.alias};if(e.data){if(typeOf(e.data)=="array"){e.data.each(function(e){a(e)})}else{a(e.data)}}else{e.data=[]}},saveCategoryExtContent:function(e,a,i,n){this.action.invoke({name:"saveCategoryExtContent",data:{id:e,content:a},success:i,failure:n})},saveCategoryImportView:function(e,a,i,n){this.action.invoke({name:"saveCategoryImportView",parameter:{categoryId:e},data:a,success:i,failure:n})},listAllForm:function(e,a,i){this.action.invoke({name:"listAllForm",async:i,success:e,failure:a})},listForm:function(e,a,i,n){this.action.invoke({name:"listForm",async:n,parameter:{appId:e},success:a,failure:i})},getForm:function(e,a,i,n){this.action.invoke({name:"getForm",async:n,parameter:{id:e},success:a,failure:i})},saveForm:function(e,a,i,n){if(!e.isNewForm){this.updateForm(e,a,i,n)}else{this.addForm(e,a,i,n)}},updateForm:function(e,a,i,n){var t,a;if(e)t=MWF.encodeJsonString(JSON.encode(e));if(a)a=MWF.encodeJsonString(JSON.encode(a));var s={id:e.json.id,name:e.json.name,alias:e.json.name,description:e.json.description,appId:e.json.application};if(e)s.data=t;if(a)s.mobileData=a;this.action.invoke({name:"updataForm",data:s,parameter:{id:e.json.id},success:i,failure:n})},addForm:function(i,n,t,s){var o,n;if(!i.json.id){this.getUUID(function(e){i.json.id=e;if(i)o=MWF.encodeJsonString(JSON.encode(i));if(n)n=MWF.encodeJsonString(JSON.encode(n));var a={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,appId:i.json.application};if(i)a.data=o;if(n)a.mobileData=n;this.action.invoke({name:"addForm",data:a,parameter:{id:i.json.id},success:t,failure:s})}.bind(this))}else{if(i)o=MWF.encodeJsonString(JSON.encode(i));if(n)n=MWF.encodeJsonString(JSON.encode(n));var e={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,appId:i.json.application};if(i)e.data=o;if(n)e.mobileData=n;this.action.invoke({name:"addForm",data:e,parameter:{id:i.json.categoryId},success:t,failure:s})}},deleteForm:function(e,a,i,n){this.action.invoke({name:"removeForm",async:n,parameter:{id:e},success:a,failure:i})},getFormTemplate:function(e,a,i,n){this.action.invoke({name:"getFormTemplate",async:n,parameter:{id:e},success:a,failure:i})},listFormTemplate:function(e,a,i){this.action.invoke({name:"listFormTemplate",async:i,success:e,failure:a})},listFormTemplateCategory:function(e,a,i){this.action.invoke({name:"listFormTemplateCategory",async:i,success:e,failure:a})},listFormTemplatByCategory:function(e,a,i){this.action.invoke({name:"listFormTemplatByCategory",async:i,success:e,failure:a})},addFormTemplate:function(n,t,s,o,c){var r,u;this.getUUID(function(e){s.id=e;if(n){var a=Object.clone(n);a.json.id=e;a.json.name=s.name;r=MWF.encodeJsonString(JSON.encode(a))}if(t){var i=Object.clone(t);i.json.id=e;i.json.name=s.name;u=MWF.encodeJsonString(JSON.encode(i))}if(n)s.data=r;if(t)s.mobileData=u;this.action.invoke({name:"addFormTemplate",data:s,success:o,failure:c})}.bind(this))},deleteFormTemplate:function(e,a,i,n){this.action.invoke({name:"deleteFormTemplate",async:n,parameter:{id:e},success:a,failure:i})},listDictionary:function(e,a,i,n){this.action.invoke({name:"listDictionary",async:n,parameter:{appId:e},success:a,failure:i})},getDictionary:function(e,a,i,n){this.action.invoke({name:"getDictionary",async:n,parameter:{appDictId:e},success:a,failure:i})},saveDictionary:function(e,a,i){if(e.id||e.appDictId){this.updateDictionary(e,a,i)}else{this.addDictionary(e,a,i)}},updateDictionary:function(e,a,i){if(!e.alias||e.alias=="")e.alias=e.name;this.action.invoke({name:"updataDictionary",data:e,parameter:{appDictId:e.id},success:a,failure:i})},addDictionary:function(a,i,n){if(!a.id){this.getUUID(function(e){a.id=e;a.appDictId=e;if(!a.alias||a.alias=="")a.alias=a.name;this.action.invoke({name:"addDictionary",data:a,parameter:{appDictId:a.id},success:i,failure:n})}.bind(this))}},deleteDictionary:function(e,a,i,n){this.action.invoke({name:"removeDictionary",async:n,parameter:{appDictId:e},success:a,failure:i})},listScript:function(e,a,i,n){var t=this;this.action.invoke({name:"listScript",async:n,parameter:{appId:e},success:a,failure:i})},getScript:function(e,a,i,n){var t=this;this.action.invoke({name:"getScript",async:n,parameter:{id:e},success:function(e){t.transScriptData(e);a.call(this,e)},failure:i})},getScriptByName:function(e,a,i,n,t){var s=this;this.action.invoke({name:"getScriptByName",async:t,parameter:{name:e,appId:a},success:function(e){s.transScriptData(e);i.call(this,e)},failure:n})},saveScript:function(e,a,i){if(!e.isNewScript){this.updateScript(e,a,i)}else{this.addScript(e,a,i)}},updateScript:function(e,a,i){this.transScriptData(e,"send");this.action.invoke({name:"updataScript",data:e,parameter:{id:e.id},success:a,failure:i})},addScript:function(a,i,n){this.transScriptData(a,"send");var e=this;if(!a.id){this.getUUID(function(e){a.id=e;this.action.invoke({name:"addScript",data:a,success:i,failure:n})}.bind(this))}else{this.action.invoke({name:"addScript",data:a,success:i,failure:n})}},deleteScript:function(e,a,i,n){this.action.invoke({name:"removeScript",async:n,parameter:{id:e},success:a,failure:i})},transScriptData:function(e,a){var i=function(e){if(a&&a=="send"){if(!e.appId)e.appId=e.application;if(!e.appName)e.appName=e.applicationName;if(e.application)delete e.application;if(e.applicationName)delete e.applicationName}else{if(!e.appId)e.appId=e.application;if(!e.appName)e.appName=e.applicationName;if(!e.application)e.application=e.appId;if(!e.applicationName)e.application=e.appName}};if(typeOf(e)=="array"){e.each(function(e){i(e)})}else{i(e)}},listAppByManager:function(e,a,i){this.action.invoke({name:"listAppByManager",async:i,success:e,failure:a})},isAppInfoManager:function(e,a,i,n){this.action.invoke({name:"isAppInfoManager",async:n,parameter:{id:e},success:a,failure:i})},isCategoryInfoManagers:function(e,a,i,n){this.action.invoke({name:"isCategoryInfoManagers",async:n,parameter:{id:e},success:a,failure:i})},listAppInfoManagers:function(e,a,i,n){this.action.invoke({name:"listAppInfoManagers",async:n,parameter:{id:e},success:a,failure:i})},listAppInfoPublishers:function(e,a,i,n){this.action.invoke({name:"listAppInfoPublishers",async:n,parameter:{id:e},success:a,failure:i})},listAppInfoViewers:function(e,a,i,n){this.action.invoke({name:"listAppInfoViewers",async:n,parameter:{id:e},success:a,failure:i})},listCategoryInfoManagers:function(e,a,i,n){this.action.invoke({name:"listCategoryInfoManagers",async:n,parameter:{id:e},success:a,failure:i})},listCategoryInfoPublishers:function(e,a,i,n){this.action.invoke({name:"listCategoryInfoPublishers",async:n,parameter:{id:e},success:a,failure:i})},listCategoryInfoViewers:function(e,a,i,n){this.action.invoke({name:"listCategoryInfoViewers",async:n,parameter:{id:e},success:a,failure:i})},saveAppInfoManager:function(e,a,i,n,t){this.action.invoke({name:"saveAppInfoManager",data:a,parameter:{id:e},async:t,success:i,failure:n})},saveAppInfoPublisher:function(e,a,i,n,t){this.action.invoke({name:"saveAppInfoPublisher",data:a,parameter:{id:e},async:t,success:i,failure:n})},saveAppInfoViewer:function(e,a,i,n,t){this.action.invoke({name:"saveAppInfoViewer",data:a,parameter:{id:e},async:t,success:i,failure:n})},saveCategoryInfoManager:function(e,a,i,n,t){this.action.invoke({name:"saveCategoryInfoManager",data:a,parameter:{id:e},async:t,success:i,failure:n})},saveCategoryInfoPublisher:function(e,a,i,n,t){this.action.invoke({name:"saveCategoryInfoPublisher",data:a,parameter:{id:e},async:t,success:i,failure:n})},saveCategoryInfoViewer:function(e,a,i,n,t){this.action.invoke({name:"saveCategoryInfoViewer",data:a,parameter:{id:e},async:t,success:i,failure:n})},listView:function(e,a,i,n){this.action.invoke({name:"listView",async:n,parameter:{appId:e},success:a,failure:i})},listViewByCategory:function(e,a,i,n){this.action.invoke({name:"listViewByCategory",async:n,parameter:{categoryId:e},success:a,failure:i})},listViewByForm:function(e,a,i,n){this.action.invoke({name:"listViewByForm",async:n,parameter:{formId:e},success:a,failure:i})},getView:function(e,a,i){this.action.invoke({name:"getView",parameter:{id:e},success:a,failure:i})},saveView:function(e,a,i){if(!e.isNew){this.updateView(e,a,i)}else{this.addView(e,a,i)}},addView:function(e,a,i){this.action.invoke({name:"addView",data:e,success:a,failure:i})},updateView:function(e,a,i){this.action.invoke({name:"updateView",data:e,parameter:{id:e.id},success:a,failure:i})},deleteView:function(e,a,i,n){this.action.invoke({name:"deleteView",async:n,parameter:{id:e},success:a,failure:i})},listViewColumn:function(e,a,i,n){this.action.invoke({name:"listViewColumn",async:n,parameter:{viewId:e},success:a,failure:i})},getViewColumn:function(e,a,i){this.action.invoke({name:"getViewColumn",parameter:{id:e},success:a,failure:i})},saveViewColumn:function(e,a,i,n){if(!e.isNew){this.updateViewColumn(e,a,i,n)}else{this.addViewColumn(e,a,i,n)}},addViewColumn:function(e,a,i,n){this.action.invoke({name:"addViewColumn",async:n,data:e,success:a,failure:i})},updateViewColumn:function(e,a,i,n){this.action.invoke({name:"updateViewColumn",async:n,data:e,parameter:{id:e.id},success:a,failure:i})},deleteViewColumn:function(e,a,i,n){this.action.invoke({name:"deleteViewColumn",async:n,parameter:{id:e},success:a,failure:i})},listCategoryViewByView:function(e,a,i,n){this.action.invoke({name:"listCategoryViewByView",async:n,parameter:{viewId:e},success:a,failure:i})},listCategoryViewByCategory:function(e,a,i,n){this.action.invoke({name:"listCategoryViewByCategory",async:n,parameter:{categoryId:e},success:a,failure:i})},getCategoryView:function(e,a,i){this.action.invoke({name:"getCategoryView",parameter:{id:e},success:a,failure:i})},saveCategoryView:function(e,a,i,n){if(!e.isNew){this.updateViewColumn(e,a,i,n)}else{this.addViewColumn(e,a,i,n)}},addCategoryView:function(e,a,i,n){this.action.invoke({name:"addCategoryView",async:n,data:e,success:a,failure:i})},updateCategoryView:function(e,a,i,n){this.action.invoke({name:"updateCategoryView",async:n,data:e,parameter:{id:e.id},success:a,failure:i})},deleteCategoryView:function(e,a,i,n){this.action.invoke({name:"deleteCategoryView",async:n,parameter:{id:e},success:a,failure:i})},listQueryView:function(e,a,i,n){this.action.invoke({name:"listQueryView",async:n,parameter:{applicationId:e},success:a,failure:i})},listQueryViewNextPage:function(e,a,i,n,t){this.action.invoke({name:"listQueryViewNextPage",async:t,parameter:{id:e,count:a},success:i,failure:n})},listQueryViewPrevPage:function(e,a,i,n,t){this.action.invoke({name:"listQueryViewPrevPage",async:t,parameter:{id:e,count:a},success:i,failure:n})},getQueryView:function(e,a,i){this.action.invoke({name:"getQueryView",parameter:{id:e},success:a,failure:i})},saveQueryView:function(e,a,i,n){if(e.isNewView){e.isNewView=false;this.addQueryView(e,a,i,n)}else{this.updateQueryView(e,a,i,n)}},addQueryView:function(a,i,n,t){var s=a.data;var e=JSON.encode(a.data);a.data=e;if(!s.id){this.getUUID(function(e){a.id=e;this.action.invoke({name:"addQueryView",data:a,success:i,failure:n,async:t});a.data=s}.bind(this))}else{this.action.invoke({name:"addQueryView",data:a,success:i,failure:n,async:t});a.data=s}},updateQueryView:function(e,a,i,n){var t=e.data;var s=JSON.encode(e.data);e.data=s;this.action.invoke({name:"updateQueryView",data:e,async:n,parameter:{id:e.id},success:a,failure:i});e.data=t},deleteQueryView:function(e,a,i,n){this.action.invoke({name:"deleteQueryView",async:n,parameter:{id:e},success:a,failure:i})},getQueryViewContent:function(e,a,i,n){this.action.invoke({name:"getQueryViewContent",async:n,parameter:{flag:e},success:a,failure:i})},loadQueryView:function(e,a,i,n){this.action.invoke({name:"loadQueryView",async:n,data:{},parameter:{flag:e},success:a,failure:i})},listApplication:function(e,a,i,n){if(e){this.actionProcess.invoke({name:"listApplicationByCategory",async:n,parameter:{applicationCategory:e},success:a,failure:i})}else{this.actionProcess.invoke({name:"listApplication",async:n,success:a,failure:i})}},listProcess:function(e,a,i,n){this.actionProcess.invoke({name:"listProcess",async:n,parameter:{id:e},success:a,failure:i})}});