MWF.xDesktop.requireApp("cms.ColumnManager","DictionaryExplorer",null,false);MWF.xApplication.cms.ColumnManager.ScriptExplorer=new Class({Extends:MWF.xApplication.cms.ColumnManager.DictionaryExplorer,Implements:[Options,Events],options:{create:MWF.CMSCM.LP.dictionary.create,search:MWF.CMSCM.LP.dictionary.search,searchText:MWF.CMSCM.LP.dictionary.searchText,noElement:MWF.CMSCM.LP.dictionary.noDictionaryNoticeText},_createElement:function(t){var i=this;var e={onQueryLoad:function(){this.actions=i.app.restActions;this.application=i.app.options.application||i.app.application||i.app.options.column||i.app.column;this.column=this.application;this.explorer=i},onPostSave:function(){i.reload()}};this.app.desktop.openApplication(t,"cms.ScriptDesigner",e)},_loadItemDataList:function(t){var i="";if(this.app.application)i=this.app.application.id;if(this.app.options.application)i=this.app.options.application.id;this.actions.listScript(i,t)},_getItemObject:function(t,i){return new MWF.xApplication.cms.ColumnManager.ScriptExplorer.Script(this,t,{index:i})},setTooltip:function(){this.options.tooltip={create:MWF.CMSCM.LP.script.create,search:MWF.CMSCM.LP.script.search,searchText:MWF.CMSCM.LP.script.searchText,noElement:MWF.CMSCM.LP.script.noScriptNoticeText}},deleteItems:function(){while(this.deleteMarkItems.length){var t=this.deleteMarkItems.shift();if(this.deleteMarkItems.length){t.deleteScript()}else{t.deleteScript(function(){this.hideDeleteAction();this.reload()}.bind(this))}}}});MWF.xApplication.cms.ColumnManager.ScriptExplorer.Script=new Class({Extends:MWF.xApplication.cms.ColumnManager.DictionaryExplorer.Dictionary,_customNodes:function(){if(!this.data.validated){new Element("div",{styles:this.explorer.css.itemErrorNode}).inject(this.node);this.node.setStyle("background-color","#f9e8e8")}},_open:function(t){var i=this;var e={onQueryLoad:function(){this.actions=i.explorer.actions;this.category=i;this.options.id=i.data.id;this.application=i.explorer.app.options.application||i.explorer.app.options.column;this.column=i.explorer.app.options.application||i.explorer.app.options.column;this.explorer=i.explorer}};this.explorer.app.desktop.openApplication(t,"cms.ScriptDesigner",e)},_getIcon:function(){var t=(Math.random()*33).toInt();return"process_icon_"+t+".png"},_getLnkPar:function(){return{icon:this.explorer.path+this.explorer.options.style+"/scriptIcon/lnk.png",title:this.data.name,par:'cms.ScriptDesigner#{"id": "'+this.data.id+'", "application": '+JSON.stringify(this.explorer.app.options.application||this.explorer.app.options.column)+"}"}},deleteScript:function(t){this.explorer.app.restActions.deleteScript(this.data.id,function(){this.node.destroy();if(t)t()}.bind(this))}});