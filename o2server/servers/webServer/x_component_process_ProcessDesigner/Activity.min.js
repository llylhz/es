MWF.xDesktop.requireApp("process.ProcessDesigner","Property",null,false);MWF.xApplication.process.ProcessDesigner.Activity=new Class({initialize:function(t,i){this.data=t;this.process=i;this.paper=this.process.paper;this.routes=[];this.fromRoutes=[];this.setType();this.setStyle();this.setSize();this.getPoint();this.selectedMultiStatus=false;this.positionLoaded=false},setType:function(){this.type="activity";this.data.type="activity"},setStyle:function(){this.style=this.process.css.activity["default"]},setSize:function(){var t=MWF.getTextSize(this.data.name,this.style.text);this.width=t.x+38;this.width=this.width<100?100:this.width;this.height=40},getPoint:function(){this.paperSize=$(this.paper.canvas).getParent().getSize();this.paperOriginalSize={x:this.paperSize.x*.99,y:this.paperSize.y*.99};var t=this.paperSize.y;var i=this.paperSize.x;this.top=t/2;this.left=i/2;this.center={x:this.left,y:this.top};this.point={x:this.left-this.width/2,y:this.top-this.height/2}},resetPoint:function(){this.center={x:this.point.x+this.width/2,y:this.point.y+this.height/2}},checkUUID:function(){for(var t=0;t<this.routes.length;t++){delete this.process.routes[this.routes[t].data.id];delete this.process.routeDatas[this.routes[t].data.id];this.routes[t].data.id=this.process.checkUUIDs.pop().id;this.routes[t].data.process=this.process.process.id;this.setRouteData(this.routes[t].data.id,t);this.routes[t].data.activity=this.routes[t].toActivity.data.id;this.process.routes[this.routes[t].data.id]=this.routes[t];this.process.routeDatas[this.routes[t].data.id]=this.routes[t].data}},loaded:function(t){if(this.positionLoaded){if(t)t()}},load:function(t){if(this.process.isNewProcess){this.data.createTime=(new Date).format("db");this.data.updateTime=(new Date).format("db")}this.draw();this.setActivityPosition(function(){this.positionLoaded=true;this.loaded(t)}.bind(this));this.setEvent();if(this.process.activityListNode)this.addToActivityList()},addToActivityList:function(){this.listItem=new MWF.APPPD.Activity.List(this);this.listItem.load()},create:function(t){this.point=t||{x:100,y:100};this.center={x:this.point.x+this.width/2,y:this.point.y+this.height/2};this.draw();this.setEvent();if(this.process.activityListNode)this.addToActivityList()},setEvent:function(){if(!this.process.options.isView){this.set.drag(function(t,i,s,e,h){if(!h.rightClick){if(this.process.selectedActivitys.length){this.noselected=true;this.process.selectedActivitys.each(function(h){h.activityMove(t,i,s,e)})}else{this.activityMove(t,i,s,e)}}}.bind(this),function(t,i,s){if(!s.rightClick){if(this.process.selectedActivitys.length){this.process.selectedActivitys.each(function(t){t.activityMoveStart()})}else{this.activityMoveStart()}}}.bind(this),function(t){if(!t.rightClick){if(this.process.selectedActivitys.length){this.process.selectedActivitys.each(function(t){t.activityMoveEnd()})}else{this.activityMoveEnd()}}}.bind(this));this.set.click(function(t){if(this.process.isCreateRoute){this.checkCreateRoute()}else{if(this.process.selectedActivitys.length){if(!this.noselected){if(this.process.currentSelected!=this){this.selected()}}this.noselected=false}}t.stopPropagation()}.bind(this));this.set.dblclick(function(){this.quickCreateRoute()}.bind(this));this.set.mousedown(function(t){if(this.process.isCreateRoute){this.checkCreateRoute()}else{if(!this.process.selectedActivitys.length){if(this.process.currentSelected!=this){this.selected()}}}t.stopPropagation()}.bind(this));this.set.hover(this.mouseHover.bind(this),function(){if(this.process.isCreateRoute||this.process.isCopyRoute||this.process.isChangeRouteTo||this.process.isChangeRouteFrom){this.shap.attr(this.style.shap)}}.bind(this));this.set.mouseup(function(){this.mouseUp()}.bind(this))}},mouseHover:function(){if(this.process.isCreateRoute||this.process.isCopyRoute||this.process.isChangeRouteTo||this.process.isChangeRouteFrom){this.shap.attr({"stroke-width":"2"})}},mouseUp:function(){if(this.process.isChangeRouteTo){this.process.currentChangeRoute.setActivity(this,null);this.process.currentChangeRoute.isBack=false;this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint();this.process.currentChangeRoute.reload();this.process.isChangeRouteTo=false;this.process.currentChangeRoute=null}if(this.process.isChangeRouteFrom){this.process.currentChangeRoute.setActivity(null,this);this.process.currentChangeRoute.isBack=false;this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint();this.process.currentChangeRoute.reload();this.process.isChangeRouteFrom=false;this.process.currentChangeRoute=null}this.shap.attr(this.style.shap)},quickCreateRoute:function(){this.process.createRoute();this.process.routeCreateFromActivity(this)},checkCreateRoute:function(){if(this.process.isCreateRoute){var t=this.process.currentCreateRoute;if(!t.fromActivity){this.process.routeCreateFromActivity(this)}else{this.process.routeCreateToActivity(this)}}if(this.process.isCopyRoute){this.process.routeAddFromActivity(this)}},draw:function(){this.set=this.paper.set();this.shap=this.createShap();this.text=this.createText();this.icon=this.createIcon();this.set.push(this.shadow,this.shap,this.text,this.icon)},redraw:function(){this.setSize();this.resetPoint();if(this.shap)this.redrawShap();if(this.text)this.redrawText();if(this.icon)this.redrawIcon();if(this.bBox)this.redrawBox();if(this.listItem)this.redrawListItem();this.redrawRoute()},careteShadow:function(){var t;t=this.shap.glow({width:10,fill:true,opacity:.2,offsetx:0,offsety:0,color:"#aaa"});t.data("bind",this);return t},createShap:function(){var t;t=this.paper.rectPath(this.point.x,this.point.y,this.width,this.height,this.style.shap.radius);t.attr(this.style.shap);t.data("bind",this);return t},createText:function(){var t=this.getTextIconPoint();text=this.paper.text(t.tatt.x,t.tatt.y,this.data.name);text.attr(this.style.text);if(this.style.text.display=="none"){text.hide()}return text},createIcon:function(){var t=this.getTextIconPoint();var i=this.paper.image(this.style.icon.src,t.iatt.x,t.iatt.y,16,16);i.attr(this.style.icon.attr);return i},redrawShap:function(){var t=MWFRaphael.getRectPath(this.point.x,this.point.y,this.width,this.height,this.style.shap.radius);this.shap.attr("path",t)},redrawText:function(){var t=this.getTextIconPoint();this.text.attr({x:t.tatt.x,y:t.tatt.y,text:this.data.name})},redrawIcon:function(){var t=this.getTextIconPoint();this.icon.attr({x:t.iatt.x,y:t.iatt.y})},redrawBox:function(){this.set.exclude(this.bBox);this.bBox.remove();this.bBox=null;var t=this.set.getBBox();this.bBox=this.paper.rectPath(t.x-3,t.y-3,t.width+6,t.height+6,0);this.bBox.attr(this.process.css.activity.box);this.set.push(this.bBox)},redrawListItem:function(){var t=this.listItem.row.tds[1];t.set("text",this.data.name)},loadRoutes:function(){var t=this.getRoutedata();t.each(function(t){if(this.process.routes[t]){this.routes.push(this.process.routes[t]);this.process.routes[t].setActivity(null,this);this.process.routes[t].load()}}.bind(this))},getRoutedata:function(){if(!this.data.routeList)this.data.routeList=[];this.data.routeList=this.data.routeList.clean();return this.data.routeList},setRouteData:function(t,i){var s=i||i==0?i:null;if(!this.data.routeList)this.data.routeList=[];if(s!=null&&s<=this.data.routeList.length){var e=this.data.routeList.indexOf(t);if(e==-1)this.data.routeList[s]=t}else{if(this.data.routeList.indexOf(t)==-1)this.data.routeList.push(t)}},removeRouteData:function(t){if(!this.data.routeList)this.data.routeList=[];this.data.routeList.erase(t)},redrawRoute:function(t){this.routes.each(function(i){i.reload(t,null)});this.fromRoutes.each(function(i){i.reload(null,t)})},activityMove:function(t,i,s,e){if(!this.set.isFront){this.set.toFront();this.set.isFront=true}if(this.set.ox+t<0)t=0-this.set.ox;if(this.set.ox+t+this.width>this.paperSize.x){this.paperSize.x=this.set.ox+t+this.width;this.paper.setSize(this.paperSize.x,this.paperSize.y);$(this.paper.canvas).getParent().setStyle("width",""+this.paperSize.x+"px")}if(this.set.oy+i<0)i=0-this.set.oy;if(this.set.oy+i+this.height>this.paperSize.y){this.paperSize.y=this.set.oy+i+this.height;this.paper.setSize(this.paperSize.x,this.paperSize.y);$(this.paper.canvas).getParent().setStyle("height",""+this.paperSize.y+"px")}var h=Raphael.snapTo(10,this.set.ox+t+this.width/2,10);var o=Raphael.snapTo(10,this.set.oy+i+this.height/2,10);t=h-this.set.ox-this.width/2;i=o-this.set.oy-this.height/2;path=Raphael.transformPath(this.set.shapPath,"t"+t+","+i);this.shap.attr("path",path);if(this.bBox){var r=this.shap.getBBox();boxPath=MWFRaphael.getRectPath(r.x-3,r.y-3,r.width+6,r.height+6,0);this.bBox.attr("path",boxPath)}this.point={x:this.set.ox+t,y:this.set.oy+i};this.center={x:this.set.ox+t+this.width/2,y:this.set.oy+i+this.height/2};var a=this.getMoveTextIconPoint();this.text.attr(a.tatt);this.icon.attr(a.iatt);this.routes.each(function(s){if(this.process.selectedActivitys.indexOf(s.toActivity)!=-1){s.corners.each(function(e,h){var o=e.data("point");var r=o.x.toFloat()+t.toFloat();var a=o.y.toFloat()+i.toFloat();var n=MWFRaphael.getRectPath(r-2.5,a-2.5,5,5,0);e.attr("path",n);s.positionPoints[h]={x:r,y:a}}.bind(this))}}.bind(this));this.set.movex=t;this.set.movey=i;this.redrawRoute();this.paper.safari()},activityMoveStart:function(){this.set.isFront=false;var t=this.shap.getBBox();this.set.ox=t.x;this.set.oy=t.y;this.set.movex=0;this.set.movey=0;this.set.animate({"fill-opacity":.5},500);this.set.shapPath=this.shap.attr("path");if(this.bBox)this.set.boxPath=this.bBox.attr("path");this.routes.each(function(t){if(this.process.selectedActivitys.indexOf(t.toActivity)!=-1){t.corners.each(function(i,s){var e=t.positionPoints[s];i.data("point",e)}.bind(this))}}.bind(this))},activityMoveEnd:function(){this.center.x=this.center.x.toInt();this.center.y=this.center.y.toInt();this.data.position=this.center.x+","+this.center.y;this.set.animate({"fill-opacity":1},500)},setActivityPosition:function(t){var i;var s;if(this.data.position){var e=this.data.position.split(/(?:,\s*){1}|(?:;\s*){1}/g);i=e[0];s=e[1]}else{var h=Math.random();i=(this.paperSize.x-300)*h;var o=Math.random();s=(this.paperSize.y-300)*o;this.data.position=i+","+s}this.reSizePaper(i,s);this.setPosition(i.toFloat(),s.toFloat(),null,t)},reSizePaper:function(t,i){i=i.toFloat()+this.height.toFloat();t=t.toFloat()+this.width.toFloat();if(t>this.paperSize.x){this.paper.setSize(t*.99,this.paperSize.y);$(this.paper.canvas).getParent().setStyle("width",""+t+"px");this.paperSize.x=t}if(i>this.paperSize.y){this.paper.setSize(this.paperSize.x*.99,i);$(this.paper.canvas).getParent().setStyle("height",""+i+"px");this.paperSize.y=i}},setPosition:function(t,i,s,e){t=t.toFloat();i=i.toFloat();if(!s)s=300;var h=t-this.center.x.toFloat();var o=i-this.center.y.toFloat();this.center={x:t,y:i};this.point={x:t-this.width/2,y:i-this.height/2};var r=this.shap.attr("path");var r=Raphael.transformPath(r,"t"+h+","+o);var a=this.getTextIconPoint();this.shap.animate({path:r},s,"<>",e);this.text.animate(a.tatt,s,"<>");this.icon.animate(a.iatt,s,"<>")},getTextIconPoint:function(){var t={x:this.center.x+10,y:this.center.y};var i={x:this.center.x-this.width/2+8,y:this.center.y-8};return{tatt:t,iatt:i}},getMoveTextIconPoint:function(){return this.getTextIconPoint()},showProperty:function(){if(!this.property){this.property=new MWF.APPPD.Activity.Property(this,{onPostLoad:function(){this.property.show()}.bind(this)});this.property.load()}else{this.property.show()}},selectedMulti:function(){if(!this.bBox){var t=this.shap.getBBox();this.bBox=this.paper.rectPath(t.x-3,t.y-3,t.width+6,t.height+6,0);this.bBox.attr(this.process.css.activity.box);this.set.push(this.bBox)}this.process.selectedActivitys.push(this);this.process.selectedActivityDatas.push(this.data);if(this.listItem)this.listItem.listUnSelected();if(this.property)this.property.hide();this.selectedMultiStatus=true},unSelectedMulti:function(){if(this.bBox){this.set.exclude(this.bBox);this.bBox.remove();this.bBox=null}this.selectedMultiStatus=false},selected:function(){this.activitySelected();if(this.listItem)this.listItem.listSelected();window.setTimeout(function(){this.showProperty()}.bind(this),10)},unSelected:function(){this.activityUnSelected();if(this.listItem)this.listItem.listUnSelected();if(this.property)this.property.hide()},showQuickAction:function(){this.getQuickActionJson(function(){this.quickActionJson.each(function(t,i){var s=this.point.y-20;var e=this.point.x+20*i;var h=this.paper.image(this.process.path+this.process.options.style+"/quickAction/"+t.icon,e,s,16,16);h.toFront()}.bind(this))}.bind(this))},getQuickActionJson:function(t){if(!this.quickActionJson){MWF.getJSON(this.process.path+"action.json",{onSuccess:function(i){var s=i["default"];var e=i[this.type];this.quickActionJson=s.concat(e);if(t)t()}.bind(this),onerror:function(t){this.notice(t,"error")}.bind(this),onRequestFailure:function(t){this.notice(t.responseText,"error")}.bind(this)})}else{if(t)t()}},activitySelected:function(){this.process.unSelectedAll();if(!this.bBox){var t=this.shap.getBBox();this.bBox=this.paper.rectPath(t.x-3,t.y-3,t.width+6,t.height+6,0);this.bBox.attr(this.process.css.activity.box);this.set.push(this.bBox)}this.process.currentSelected=this},activityUnSelected:function(){this.process.currentSelected=null;if(this.bBox){this.set.exclude(this.bBox);this.bBox.remove();this.bBox=null}},addRouteData:function(t){if(this.data.routeList.indexOf(t)==-1)this.data.routeList.push(t)},destroy:function(){if(this.type=="begin"){this.process.begin=null;this.process.process.begin=null}this.routes.each(function(t){t.destroy()});this.fromRoutes.each(function(t){t.destroy()});if(this.listItem){this.listItem.row.tr.destroy()}var t={};for(aid in this.process[this.type+"s"]){if(aid!=this.data.id){t[aid]=this.process[this.type+"s"][aid]}else{this.process[this.type+"s"][aid]=null}}this.process[this.type+"s"]=null;this.process[this.type+"s"]=t;this.process.activitys.erase(this);if(this.process.process[this.type+"List"])this.process.process[this.type+"List"].erase(this.data);this.set.remove()}});MWF.APPPD.Activity.SingleRouter=new Class({Extends:MWF.APPPD.Activity,getRoutedata:function(){if(!this.data.route)this.data.route="";return[this.data.route]},setRouteData:function(t){if(!this.data.route)this.data.route="";this.data.route=t},removeRouteData:function(t){this.data.route=""},quickCreateRoute:function(){if(!this.routes.length){this.process.createRoute();this.process.routeCreateFromActivity(this)}},checkCreateRoute:function(){if(this.process.isCreateRoute){var t=this.process.currentCreateRoute;if(!t.fromActivity){if(!this.routes.length)this.process.routeCreateFromActivity(this)}else{this.process.routeCreateToActivity(this)}}if(this.process.isCopyRoute){if(!this.routes.length)this.process.routeAddFromActivity(this)}},mouseHover:function(){if(this.process.isCreateRoute){var t=this.process.currentCreateRoute;if(!t.fromActivity){if(!this.routes.length)this.shap.attr({"stroke-width":"2"})}else{this.shap.attr({"stroke-width":"2"})}}if(this.process.isChangeRouteTo){this.shap.attr({"stroke-width":"2"})}if(this.process.isChangeRouteFrom||this.process.isCopyRoute){if(!this.routes.length)this.shap.attr({"stroke-width":"2"})}},mouseUp:function(){if(this.process.isChangeRouteTo){this.process.currentChangeRoute.setActivity(this,null);this.process.currentChangeRoute.isBack=false;this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint();this.process.currentChangeRoute.reload();this.process.isChangeRouteTo=false;this.process.currentChangeRoute=null}if(this.process.isChangeRouteFrom){if(!this.routes.length){this.process.currentChangeRoute.setActivity(null,this);this.process.currentChangeRoute.isBack=false;this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint();this.process.currentChangeRoute.reload();this.process.isChangeRouteFrom=false;this.process.currentChangeRoute=null}}this.shap.attr(this.style.shap)},addRouteData:function(t){if(!this.data.route)this.data.route=t}});MWF.APPPD.Activity.Circle=new Class({Extends:MWF.APPPD.Activity,setSize:function(){if(this.style.text.display=="none"){this.width=this.style.shap.width;this.height=this.style.shap.height;this.radius=this.style.shap.radius}else{var t=MWF.getTextSize(this.data.name,this.style.text);this.radius=t.x/2+10;this.radius=this.radius<20?20:this.radius;this.width=this.height=this.radius*2}},reSizePaper:function(t,i){i=i.toFloat()+this.height.toFloat()/2;t=t.toFloat()+this.width.toFloat()/2;if(t>this.paperSize.x){this.paper.setSize(t*.99,this.paperSize.y);$(this.paper.canvas).getParent().setStyle("width",""+t+"px");this.paperSize.x=t}if(i>this.paperSize.y){this.paper.setSize(this.paperSize.x*.99,i);$(this.paper.canvas).getParent().setStyle("height",""+i+"px");this.paperSize.y=i}},resetPoint:function(){this.point={x:this.center.x-this.width/2,y:this.center.y-this.height/2}},createShap:function(){var t;t=this.paper.circlePath(this.center.x,this.center.y,this.radius);t.attr(this.style.shap);t.data("bind",this);return t},redrawText:function(){return true},redrawShap:function(){var t=MWFRaphael.getCirclePath(this.center.x,this.center.y,this.radius);this.shap.attr("path",t)},getOffset:function(){return{tx:6,ty:0,ix:-8,iy:-8}},getTextIconPoint:function(){var t=this.getOffset();if(this.style.text.display=="none"){var i={x:this.center.x+t.tx,y:this.center.y+t.ty};var s={x:this.center.x+t.ix,y:this.center.y+t.iy};return{tatt:i,iatt:s}}else{var i={x:this.center.x+6,y:this.center.y};var s={x:this.center.x-this.width/2,y:this.center.y-8};return{tatt:i,iatt:s}}},getMoveOffset:function(){return{tx:6,ty:0,ix:-9,iy:-9}},getMoveTextIconPoint:function(){var t=this.getMoveOffset();if(this.style.text.display=="none"){var i={x:this.center.x+t.tx,y:this.center.y+t.ty};var s={x:this.center.x+t.ix,y:this.center.y+t.iy};return{tatt:i,iatt:s}}else{var i={x:this.center.x+6,y:this.center.y};var s={x:this.center.x-this.width/2,y:this.center.y-8};return{tatt:i,iatt:s}}}});MWF.APPPD.Activity.Circle.SingleRouter=new Class({Extends:MWF.APPPD.Activity.Circle,getRoutedata:function(){if(!this.data.route)this.data.route="";return[this.data.route]},setRouteData:function(t){if(!this.data.route)this.data.route="";this.data.route=t},removeRouteData:function(t){this.data.route=""},quickCreateRoute:function(){if(!this.routes.length){this.process.createRoute();this.process.routeCreateFromActivity(this)}},checkCreateRoute:function(){if(this.process.isCreateRoute){var t=this.process.currentCreateRoute;if(!t.fromActivity){if(!this.routes.length)this.process.routeCreateFromActivity(this)}else{this.process.routeCreateToActivity(this)}}if(this.process.isCopyRoute){if(!this.routes.length)this.process.routeAddFromActivity(this)}},mouseHover:function(){if(this.process.isCreateRoute){var t=this.process.currentCreateRoute;if(!t.fromActivity){if(!this.routes.length)this.shap.attr({"stroke-width":"2"})}else{this.shap.attr({"stroke-width":"2"})}}if(this.process.isChangeRouteTo){this.shap.attr({"stroke-width":"2"})}if(this.process.isChangeRouteFrom||this.process.isCopyRoute){if(!this.routes.length)this.shap.attr({"stroke-width":"2"})}},mouseUp:function(){if(this.process.isChangeRouteTo){this.process.currentChangeRoute.setActivity(this,null);this.process.currentChangeRoute.isBack=false;this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint();this.process.currentChangeRoute.reload();this.process.isChangeRouteTo=false;this.process.currentChangeRoute=null}if(this.process.isChangeRouteFrom){if(!this.routes.length){this.process.currentChangeRoute.setActivity(null,this);this.process.currentChangeRoute.isBack=false;this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint();this.process.currentChangeRoute.reload();this.process.isChangeRouteFrom=false;this.process.currentChangeRoute=null}}this.shap.attr(this.style.shap)},addRouteData:function(t){if(!this.data.route)this.data.route=t}});MWF.APPPD.Activity.Circle.NoRouter=new Class({Extends:MWF.APPPD.Activity.Circle,quickCreateRoute:function(){return false},checkCreateRoute:function(){if(this.process.isCreateRoute){var t=this.process.currentCreateRoute;if(t.fromActivity){this.process.routeCreateToActivity(this)}}},mouseHover:function(){if(this.process.isCreateRoute){var t=this.process.currentCreateRoute;if(t.fromActivity){this.shap.attr({"stroke-width":"2"})}}if(this.process.isChangeRouteTo){this.shap.attr({"stroke-width":"2"})}},mouseUp:function(){if(this.process.isChangeRouteTo){this.process.currentChangeRoute.setActivity(this,null);this.process.currentChangeRoute.isBack=false;this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint();this.process.currentChangeRoute.reload();this.process.isChangeRouteTo=false;this.process.currentChangeRoute=null}this.shap.attr(this.style.shap)},addRouteData:function(t){}});MWF.APPPD.Activity.Diamond=new Class({Extends:MWF.APPPD.Activity,setSize:function(){var t=MWF.getTextSize(this.data.name,this.style.text);this.width=t.x+80;this.width=this.width<120?120:this.width;this.height=this.width*.4},createShap:function(){var t;t=this.paper.diamond(this.point.x,this.point.y,this.width,this.height,this.style.shap.radiusX,this.style.shap.radiusY);t.attr(this.style.shap);t.data("bind",this);return t},redrawShap:function(){var t=MWFRaphael.getDiamondPath(this.point.x,this.point.y,this.width,this.height,this.style.shap.radiusX,this.style.shap.radiusY);this.shap.attr("path",t)},getTextIconPoint:function(){var t={x:this.center.x+6,y:this.center.y+1};var i={x:this.center.x-this.width/2+28,y:this.center.y-9};return{tatt:t,iatt:i}}});(function(){var t=function(t,i){return new Class({Extends:t,setType:function(){this.type=i;this.data.type=i},setStyle:function(){this.style=this.process.css.activity[i]}})};MWF.APPPD.Activity.Begin=new t(MWF.APPPD.Activity.Circle.SingleRouter,"begin");MWF.APPPD.Activity.End=new t(MWF.APPPD.Activity.Circle.NoRouter,"end");MWF.APPPD.Activity.Cancel=new t(MWF.APPPD.Activity.Circle.NoRouter,"cancel");MWF.APPPD.Activity.Manual=new t(MWF.APPPD.Activity,"manual");MWF.APPPD.Activity.Condition=new t(MWF.APPPD.Activity.Diamond,"condition");MWF.APPPD.Activity.Choice=new t(MWF.APPPD.Activity.Diamond,"choice");MWF.APPPD.Activity.Split=new t(MWF.APPPD.Activity.Circle.SingleRouter,"split");MWF.APPPD.Activity.Parallel=new t(MWF.APPPD.Activity.Circle,"parallel");MWF.APPPD.Activity.Merge=new t(MWF.APPPD.Activity.Circle.SingleRouter,"merge");MWF.APPPD.Activity.Embed=new t(MWF.APPPD.Activity.SingleRouter,"embed");MWF.APPPD.Activity.Delay=new t(MWF.APPPD.Activity.Circle.SingleRouter,"delay");MWF.APPPD.Activity.Invoke=new t(MWF.APPPD.Activity.SingleRouter,"invoke");MWF.APPPD.Activity.Service=new t(MWF.APPPD.Activity.SingleRouter,"service");MWF.APPPD.Activity.Agent=new t(MWF.APPPD.Activity.SingleRouter,"agent");MWF.APPPD.Activity.Message=new t(MWF.APPPD.Activity.SingleRouter,"message")})();MWF.xApplication.process.ProcessDesigner.Activity.List=new Class({initialize:function(t){this.activity=t;this.process=t.process;this.paper=this.activity.process.paper},load:function(){var t=this.activity.type=="begin"?" ":'<img src="'+"/x_component_process_ProcessDesigner/$Process/default/icon/copy.png"+'" />';this.row=this.process.activityTable.push([{content:" ",properties:{styles:this.activity.style.listIcon}},{content:this.activity.data.name,properties:{styles:this.process.css.list.listText}},{content:t,properties:{styles:this.process.css.list.listIcon,events:{click:this.copyActivity.bind(this)}}},{content:'<img src="'+"/x_component_process_ProcessDesigner/$Process/default/icon/delete.png"+'" />',properties:{styles:this.process.css.list.listIcon,events:{click:this.deleteActivity.bind(this)}}}]);this.row.tr.addEvent("click",function(){this.activity.selected()}.bind(this))},copyActivity:function(){this.process.copyActivity(this.activity)},deleteActivity:function(t){this.process.deleteActivity(t,this.activity)},listSelected:function(){if(this.process.currentListSelected)this.process.currentListSelected.listUnSelected();this.row.tr.setStyles(this.process.css.list.listRowSelected);this.process.currentListSelected=this},listUnSelected:function(){this.process.currentListSelected=null;this.row.tr.setStyles(this.process.css.list.listRow)}});MWF.xApplication.process.ProcessDesigner.Activity.Property=new Class({Implements:[Options,Events],Extends:MWF.APPPD.Property,initialize:function(t,i){this.setOptions(i);this.activity=t;this.process=t.process;this.paper=this.activity.process.paper;this.data=t.data;this.htmlPath="/x_component_process_ProcessDesigner/$Process/"+this.activity.type+".html"},setValue:function(t,i){this.data[t]=i;if(t=="name"){if(!i)this.data[t]=MWF.APPPD.LP.unnamed;this.activity.redraw()}}});