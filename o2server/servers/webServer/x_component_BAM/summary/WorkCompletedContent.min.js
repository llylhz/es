MWF.xApplication.BAM.summary=MWF.xApplication.BAM.summary||{};MWF.xDesktop.requireApp("BAM","summary.TaskCompletedContent",null,false);MWF.xApplication.BAM.summary.WorkCompletedContent=new Class({Extends:MWF.xApplication.BAM.summary.TaskCompletedContent,Implements:[Options,Events],options:{style:"default"},initialize:function(t,i,a,e){this.setOptions(e);this.summary=t;this.app=this.summary.app;this.css=this.app.css;this.lp=this.app.lp;this.container=$(i);this.category="application";this.data=this.summary.categoryData;this.maxColumn=10;this.barOptions={style:"work"};this.load()},load:function(){this.loadArea(this.lp.workCompleted);this.loadBarData(this.loadBar.bind(this))},loadCategory:function(){var t=new MWF.widget.UUID;var i="<input name='"+t+"TaskRankCategory' type='radio' value='application' checked>"+this.lp.application+"<input name='"+t+"TaskRankCategory' type='radio' value='process'>"+this.lp.process;this.categoryNode.set("html",i);var a=this;this.categoryNode.getElements("input").addEvent("click",function(){a.category=this.value;a.reload()})},reloadMaxChart:function(){this.node.inject(this.maxNode);this.node.setStyles(this.css.taskContentNode_max);this.chartAreaNode.setStyles(this.css.contentChartAreaNode_max);this.actionNode.setStyles(this.css.taskRankActionNode_max);var t=this.chartAreaNode.getSize();var i=t.y-80;this.countNode.setStyle("height",""+i+"px");this.expiredNode.setStyle("height",""+i+"px");this.expiredCountNode.setStyle("height",""+i+"px");if(this.timeoutRateNode)this.timeoutRateNode.setStyle("height",""+i+"px");if(this.timelinessRateNode)this.timelinessRateNode.setStyle("height",""+i+"px");this.maxColumn=Math.round(t.x/40);this.barOptions={marginBottom:100,delay:10,style:"work_max"};this.reload()},loadBar:function(){MWF.require("MWF.widget.chart.Bar",function(){this.countPage.addEvent("show",function(){if(!this.countBar){this.countBar=this.loadBarChart(this.countNode,this[this.category+"Data"].workCompletedCount.slice(0,this.maxColumn),this.barOptions)}else{this.countBar.transition()}}.bind(this));this.expiredPage.addEvent("show",function(){if(!this.elapsedBar){this.elapsedBar=this.loadBarChart(this.expiredNode,this[this.category+"Data"].workCompletedDuration.slice(0,this.maxColumn),this.barOptions)}else{this.elapsedBar.transition()}}.bind(this));this.expiredCountPage.addEvent("show",function(){if(!this.elapsedCountBar){this.elapsedCountBar=this.loadBarChart(this.expiredCountNode,this[this.category+"Data"].workCompletedElapsedCount.slice(0,this.maxColumn),this.barOptions)}else{this.elapsedCountBar.transition()}}.bind(this));this.timeoutRatePage.addEvent("show",function(){if(!this.timeoutRateBar){var t=this.barOptions?Object.clone(this.barOptions):{};t.tickFormat=".0%";t.dataFormat=".1%";this.timeoutRateBar=this.loadBarChart(this.timeoutRateNode,this[this.category+"Data"].workTimeoutRate.slice(0,this.maxColumn),t)}else{this.timeoutRateBar.transition()}}.bind(this));this.timelinessRatePage.addEvent("show",function(){if(!this.timelinessRateBar){var t=this.barOptions?Object.clone(this.barOptions):{};t.tickFormat=".0%";t.dataFormat=".1%";this.timelinessRateBar=this.loadBarChart(this.timelinessRateNode,this[this.category+"Data"].workTimelinessRate.slice(0,this.maxColumn),t)}else{this.timelinessRateBar.transition()}}.bind(this));if(this.countPage.isShow){this.countPage.showIm()}else{this.countPage.showTabIm()}}.bind(this))},loadApplicationData:function(t){if(!this.applicationData){this.applicationData=this.app.actions.getWorkCompletedContentData(this.summary.categoryData.application||[]);if(t)t()}else{if(t)t()}},loadProcessData:function(t){if(!this.processData){this.processData=this.app.actions.getWorkCompletedContentData(this.summary.categoryData.process||[]);if(t)t()}else{if(t)t()}},loadActivityData:function(t){if(!this.activityData){this.activityData=this.app.actions.getWorkCompletedContentData(this.summary.categoryData.activity||[],function(t){return t.processName+"-"+t.name});if(t)t()}else{if(t)t()}}});