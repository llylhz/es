MWF.xDesktop.requireApp("process.FormDesigner","Property",null,false);MWF.xApplication.cms.FormDesigner.Property=MWF.CMSFCProperty=new Class({Extends:MWF.FCProperty,loadScriptEditor:function(t,o){t.each(function(i){var e=i.get("title");var n=i.get("name");var s=this.data[n];MWF.require("MWF.widget.ScriptArea",function(){var t=new MWF.widget.ScriptArea(i,{title:e,maxObj:this.designer.formContentNode,onChange:function(){this.data[n]=t.toJson()}.bind(this),onSave:function(){this.designer.saveForm()}.bind(this),style:o||"default",helpStyle:"cms"});t.load(s)}.bind(this))}.bind(this))},getViewList:function(i,t){if(!this.views||t){this.form.designer.actions.listQueryView(this.form.designer.application.id,function(t){this.views=t.data;if(i)i()}.bind(this))}else{if(i)i()}},loadActionArea:function(){var t=this.propertyContent.getElements(".MWFActionArea");t.each(function(i){var e=i.get("name");var n=this.data[e];MWF.xDesktop.requireApp("cms.FormDesigner","widget.ActionsEditor",function(){var t=new MWF.xApplication.cms.FormDesigner.widget.ActionsEditor(i,this.designer,{maxObj:this.propertyNode.parentElement.parentElement.parentElement,onChange:function(){this.data[e]=t.data}.bind(this)});t.load(n)}.bind(this))}.bind(this))},loadEventsEditor:function(){var i=this.propertyContent.getElement(".MWFEventsArea");if(i){var t=i.get("name");var e=this.data[t];MWF.xDesktop.requireApp("cms.FormDesigner","widget.EventsEditor",function(){var t=new MWF.xApplication.cms.FormDesigner.widget.EventsEditor(i,this.designer,{maxObj:this.designer.formContentNode});t.load(e)}.bind(this))}},loadValidation:function(){var t=this.propertyContent.getElements(".MWFValidation");if(t.length){t.each(function(t){var e=t.get("name");MWF.xDesktop.requireApp("cms.FormDesigner","widget.ValidationEditor",function(){var i=new MWF.xApplication.cms.FormDesigner.widget.ValidationEditor(t,this.designer,{onChange:function(){var t=i.getValidationData();this.data[e]=t}.bind(this)});i.load(this.data[e])}.bind(this))}.bind(this))}}});MWF.xApplication.cms.FormDesigner.PropertyMulti=new Class({Extends:MWF.xApplication.cms.FormDesigner.Property,Implements:[Options,Events],initialize:function(t,i,e,n,s){this.setOptions(s);this.modules=i;this.form=t;this.data={};this.htmlPath=this.options.path;this.designer=n;this.maplists={};this.propertyNode=e},load:function(){if(this.fireEvent("queryLoad")){MWF.getRequestText(this.htmlPath,function(t,i){this.htmlString=t;MWF.require("MWF.widget.JsonTemplate",function(){this.fireEvent("postLoad")}.bind(this))}.bind(this))}},show:function(){if(!this.propertyContent){if(this.htmlString){this.JsonTemplate=new MWF.widget.JsonTemplate({},this.htmlString);this.propertyContent=new Element("div",{styles:{overflow:"hidden"}}).inject(this.propertyNode);this.propertyContent.set("html",this.JsonTemplate.load());this.setEditNodeEvent();this.setEditNodeStyles(this.propertyContent);this.loadPropertyTab();this.loadMaplist();this.loadScriptArea();this.loadTreeData();this.loadArrayList()}}else{this.propertyContent.setStyle("display","block")}},hide:function(){if(this.propertyContent)this.propertyContent.destroy()},changeStyle:function(i){this.modules.each(function(t){t.setPropertiesOrStyles(i)}.bind(this))},changeData:function(i,e,n){this.modules.each(function(t){t._setEditStyle(i,e,n)}.bind(this))},changeJsonDate:function(i,e){this.modules.each(function(t){t.json[i]=e}.bind(this))}});