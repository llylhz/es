MWF.xApplication.cms.FormDesigner.widget=MWF.xApplication.cms.FormDesigner.widget||{};MWF.xDesktop.requireApp("process.FormDesigner","widget.ValidationEditor",null,false);MWF.xApplication.cms.FormDesigner.widget.ValidationEditor=new Class({Extends:MWF.xApplication.process.FormDesigner.widget.ValidationEditor,loadStatus:function(e){var t="<table width='100%' border='0' cellpadding='0' cellspacing='0'><tr>"+"<td width='140px'>"+"<input type='radio' value='all' checked />"+this.designer.lp.validation.anytime+"<input type='radio' value='publish' />"+this.designer.lp.validation.publish+"</td>"+"</tr></table>";e[0].set("html",t);var i=e[0].getElements("input");var a=(new MWF.widget.UUID).toString();i[0].set("name","condition"+a);i[1].set("name","condition"+a);this.statusRadioNodes=i},getData:function(){var e=this.getStatusValue();var t=this.valueTypeSelectNode.options[this.valueTypeSelectNode.selectedIndex].value;var i=this.operateorSelectNode.options[this.operateorSelectNode.selectedIndex].value;var a=this.valueInputNode.get("value");var o=this.promptInputNode.get("value");if(a==this.designer.lp.validation.valueInput)a="";return{status:e,valueType:t,operateor:i,value:a,prompt:o}},addValidation:function(){this.hideErrorNode();var e=this.getData();if(e.operateor!="isnull"&&e.operateor!="notnull"){if(!e.value||e.value==this.designer.lp.validation.valueInput){this.showErrorNode(this.designer.lp.validation.inputValue);return false}}if(!e.prompt){this.showErrorNode(this.designer.lp.validation.inputPrompt);return false}var t=new MWF.xApplication.cms.FormDesigner.widget.ValidationEditor.Item(e,this);this.items.push(t);t.selected();this.fireEvent("change")},modifyValidation:function(){if(this.currentItem){this.hideErrorNode();var e=this.getData();if(e.operateor!="isnull"&&e.operateor!="notnull"){if(!e.value||e.value==this.designer.lp.validation.valueInput){this.showErrorNode(this.designer.lp.validation.inputValue);return false}}if(!e.prompt){this.showErrorNode(this.designer.lp.validation.inputPrompt);return false}this.currentItem.reload(e);this.currentItem.unSelected();this.disabledModify();this.fireEvent("change")}},loadListNode:function(e){if(e){if(e.length){e.each(function(e){var t=new MWF.xApplication.cms.FormDesigner.widget.ValidationEditor.Item(e,this);this.items.push(t)}.bind(this))}}},setData:function(e){if(e.status){for(var t=0;t<this.statusRadioNodes.length;t++){if(e.status==this.statusRadioNodes[t].get("value")){this.statusRadioNodes[t].set("checked",true);break}}}else{this.statusRadioNodes[0].set("checked",true)}for(var t=0;t<this.valueTypeSelectNode.options.length;t++){if(e.valueType==this.valueTypeSelectNode.options[t].get("value")){this.valueTypeSelectNode.options[t].set("selected",true);break}}for(var t=0;t<this.operateorSelectNode.options.length;t++){if(e.operateor==this.operateorSelectNode.options[t].get("value")){this.operateorSelectNode.options[t].set("selected",true);break}}if(e.value)this.valueInputNode.set("value",e.value);if(e.prompt)this.promptInputNode.set("value",e.prompt)}});MWF.xApplication.cms.FormDesigner.widget.ValidationEditor.Item=new Class({Extends:MWF.xApplication.process.FormDesigner.widget.ValidationEditor.Item,getText:function(){var e="";if(this.data.status=="all"){e=this.lp.validation.anytime+" "}else{e=this.lp.validation.publish}e+=this.lp.validation[this.data.valueType]+" ";e+=this.lp.validation[this.data.operateor]+" ";e+=' "'+this.data.value+'" ';e+=this.lp.validation.prompt+': "'+this.data.prompt+'"';return e}});