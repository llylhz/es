MWF.xApplication.cms.FormDesigner.Module=MWF.xApplication.cms.FormDesigner.Module||{};MWF.xDesktop.requireApp("process.FormDesigner","Module.Actionbar",null,false);MWF.require("MWF.widget.SimpleToolbar",null,false);MWF.xApplication.cms.FormDesigner.Module.Actionbar=MWF.CMSFCActionbar=new Class({Extends:MWF.FCActionbar,options:{style:"default",propertyPath:"/x_component_cms_FormDesigner/Module/Actionbar/actionbar.html"},Implements:[MWF.CMSFCMI],initialize:function(t,o){this.setOptions(o);this.path="/x_component_cms_FormDesigner/Module/Actionbar/";this.cssPath="/x_component_cms_FormDesigner/Module/Actionbar/"+this.options.style+"/css.wcss";this._loadCss();this.moduleType="component";this.moduleName="actionbar";this.Node=null;this.form=t;this.container=null;this.containerNode=null;this.systemTools=[]},_createNode:function(t){this.node=new Element("div",{id:this.json.id,MWFType:"actionbar",styles:this.css.moduleNode,events:{selectstart:function(t){t.preventDefault()}}}).inject(this.form.node);if(this.form.options.mode=="Mobile"){this.node.set("text",MWF.APPFD.LP.notice.notUseModuleInMobile+"("+this.moduleName+")");this.node.setStyles({height:"24px","line-height":"24px","background-color":"#999"})}else{this.toolbarNode=new Element("div").inject(this.node);this.toolbarWidget=new MWF.widget.SimpleToolbar(this.toolbarNode,{style:this.json.style},this);MWF.getJSON(this.path+"toolbars.json",function(t){this.setToolbars(t,this.toolbarNode);this.toolbarWidget.load();this._setEditStyle_custom("hideSetPopularDocumentTool")}.bind(this),false)}},_refreshActionbar:function(){if(this.form.options.mode=="Mobile"){this.node.set("text",MWF.APPFD.LP.notice.notUseModuleInMobile+"("+this.moduleName+")");this.node.setStyles({height:"24px","line-height":"24px","background-color":"#999"})}else{this.toolbarNode=this.node.getFirst("div");this.toolbarNode.empty();this.toolbarWidget=new MWF.widget.SimpleToolbar(this.toolbarNode,{style:this.json.style},this);MWF.getJSON(this.path+"toolbars.json",function(t){this.setToolbars(t,this.toolbarNode);this.toolbarWidget.load();this._setEditStyle_custom("hideSetPopularDocumentTool")}.bind(this),false)}},setToolbars:function(t,s){t.each(function(t){var o=new Element("div",{MWFnodetype:t.type,MWFButtonImage:this.path+""+this.options.style+"/tools/"+(this.json.style||"default")+"/"+t.img,MWFButtonImageOver:this.path+""+this.options.style+"/tools/"+(this.json.style||"default")+"/"+t.img_over,title:t.title,MWFButtonAction:t.action,MWFButtonText:t.text}).inject(s);this.systemTools.push(o);if(t.sub){var e=s.getLast();this.setToolbars(t.sub,e)}}.bind(this))},_setEditStyle_custom:function(t){if(t=="hideSetPopularDocumentTool"){if(this.json.hideSetPopularDocumentTool){this.systemTools.each(function(t){if(t.get("MWFButtonAction")=="setPopularDocument"){t.setStyle("display","none")}})}else{this.systemTools.each(function(t){if(t.get("MWFButtonAction")=="setPopularDocument"){t.setStyle("display","block")}})}}}});