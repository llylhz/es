MWF.xApplication.Template=MWF.xApplication.Template||{};MWF.xApplication.Template.widget=MWF.xApplication.Template.widget||{};MWF.require("MWF.widget.ImageClipper",null,false);MWF.xApplication.Template.widget.ImageClipper=new Class({Implements:[Options,Events],Extends:MWF.widget.Common,options:{reference:"",referenceType:"",imageUrl:"",description:"",ratioAdjustedEnable:false,title:"Select Image",style:"default",aspectRatio:1.5},initialize:function(e,t){this.setOptions(t);this.app=e;this.path="/x_component_Template/widget/$ImageClipper/";this.cssPath="/x_component_Template/widget/$ImageClipper/"+this.options.style+"/css.wcss";this._loadCss()},load:function(e){this.data=e;var t={};var i="668";var o="510";i=i.toInt();o=o.toInt();var a=this.app.content.getSize();var s=(a.x-i)/2;var n=(a.y-o)/2;if(s<0)s=0;if(n<0)n=0;if(layout.mobile){s=20;n=0}var p=this;MWF.require("MWF.xDesktop.Dialog",function(){var e=new MWF.xDesktop.Dialog({title:this.options.title||"Select Image",style:t.style||"image",top:n,left:s-20,fromTop:n,fromLeft:s-20,width:i,height:o,html:"<div></div>",maskNode:this.app.content,container:this.app.content,buttonList:[{text:MWF.LP.process.button.ok,action:function(){p.image.uploadImage(function(e){p.imageSrc=MWF.xDesktop.getImageSrc(e.id);p.imageId=e.id;p.fireEvent("change");this.close()}.bind(this))}},{text:MWF.LP.process.button.cancel,action:function(){this.close()}}]});e.show();this.image=new MWF.widget.ImageClipper(e.content.getFirst(),{aspectRatio:this.options.aspectRatio,description:this.options.description,imageUrl:this.options.imageUrl,ratioAdjustedEnable:this.options.ratioAdjustedEnable,reference:this.options.reference,referenceType:this.options.referenceType,resetEnable:true});this.image.load(this.data)}.bind(this))}});