MWF.xApplication.Minder=MWF.xApplication.Minder||{};MWF.xApplication.Minder.Actions=MWF.xApplication.Minder.Actions||{};MWF.require("MWF.xDesktop.Actions.RestActions",null,false);MWF.xApplication.Minder.Actions.RestActions2=new Class({Extends:MWF.xDesktop.Actions.RestActions,invoke:function(e){this.getActions(function(){var t=this.actions[e.name];var i=t.method||"GET";var n=t.uri;if(e.parameter){Object.each(e.parameter,function(t,i){var s=new RegExp("{"+i+"}","g");if(e.urlEncode===false){n=n.replace(s,t)}else{n=n.replace(s,encodeURIComponent(t))}})}n=this.address+n;var s=e.async===false?false:true;var a=e.progress===false?false:true;var o=new MWF.xDesktop.Actions.RestActions.Callback(e.success,e.failure);if(t.enctype&&t.enctype.toLowerCase()=="formdata"){this.invokeFormData(i,n,e.data,e.file,o,s,a)}else{var r=e.data?JSON.encode(e.data):"";var c=true;if(e.withCredentials===false){c=false}MWF.restful(i,n,r,o,s,c)}}.bind(this))},invokeFormData:function(e,t,i,n,s,a,o){var r=new COMMON.Browser.Request;i.append("fileName",n.name);if(r.upload&&o){this.invokeFormDataWithProgress(r,e,t,i,n,s,a)}else{this.invokeFormDataWithoutProgress(r,e,t,i,n,s,a)}},invokeFormDataWithoutProgress:function(e,t,i,n,s,a,o){var r=null;var c=new Date;e.addEventListener("readystatechange",function(t){if(e.readyState==4){this.xhrStateChange(t,e,r,a)}}.bind(this),false);e.open(t,i,true);e.withCredentials=true;e.send(n)}});MWF.xAction.RestActions.Action["x_mind_assemble_control"]=new Class({Extends:MWF.xAction.RestActions.Action,initialize:function(e,t){this.action=new MWF.xApplication.Minder.Actions.RestActions2("/xAction/services/"+e+".json",e,"");this.action.actions=t;Object.each(this.action.actions,function(e,t){if(e.uri)if(!this[t])this.createMethod(e,t)}.bind(this))},uploadMindIcon:function(e,t,i,n,s,a,o){this.action.invoke({name:"uploadMindIcon",parameter:{mindId:e,size:t},data:s,file:a,success:i,failure:n,progress:o})}});