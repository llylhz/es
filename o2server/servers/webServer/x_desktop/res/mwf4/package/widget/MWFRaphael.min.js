MWF.widget=MWF.widget||{};MWF.widget.MWFRaphael=MWFRaphael={load:function(a){if(window.Raphael){if(a)a()}else{COMMON.AjaxModule.loadDom("raphael",function(){this.expandRaphael();if(a)a()}.bind(this),true,true)}},expandRaphael:function(){Raphael.fn.diamond=function(a,t,r,h,n,e){return MWFRaphael.diamond.call(this,a,t,r,h,n,e)};Raphael.fn.rectPath=function(a,t,r,h,n){return MWFRaphael.rectPath.call(this,a,t,r,h,n)};Raphael.fn.circlePath=function(a,t,r){return MWFRaphael.circlePath.call(this,a,t,r)};Raphael.fn.arrow=function(a,t,r,h,n){return MWFRaphael.arrow.call(this,a,t,r,h,n)}},rectPath:function(a,t,r,h,n){var e=MWFRaphael.getRectPath(a,t,r,h,n);return this.path(e)},getRectPath:function(a,t,r,h,n){a=a.toFloat();t=t.toFloat();r=r.toFloat();h=h.toFloat();n=n.toFloat();var e={x:a+r-n,y:t+h-n};var v=h-n-n;var i=r-n-n;var M=Raphael.parsePathString(MWFRaphael.getArcPath(e.x,e.y,n));var s=e.x;var o=e.y;var l=Raphael.transformPath(M,"r-90,"+s+","+o+"T0,-"+v);o=o-v;var x=Raphael.transformPath(l,"r-90,"+s+","+o+"T-"+i+",0");s=s-i;var p=Raphael.transformPath(x,"r-90,"+s+","+o+"T0,"+v);var y=a+r;var P=t+h-n;var c=a+r;var u=t+n;var f=Raphael.parsePathString("M"+y+","+P+"L"+c+","+u);var R=a+r-n;var g=t;var F=a+n;var d=t;var I=Raphael.parsePathString("M"+R+","+g+"L"+F+","+d);var W=Raphael.transformPath(f,"t-"+r+",0"+"R180");var m=Raphael.transformPath(I,"t0,"+h+"R180");return""+M+f[1]+l[1]+I[1]+x[1]+W[1]+p[1]+m[1]+"Z"},circlePath:function(a,t,r){var h=MWFRaphael.getCirclePath(a,t,r);return this.path(h)},getArcPath:function(a,t,r){a=a.toFloat();t=t.toFloat();r=r.toFloat();var h=a;var n=t+r;var e;var v=n;var i=a+r;var M;var s=a+r;var o=t;var l=Math.sqrt(r*r/2);var x=h+l;var p=o+l;e=(x-.125*h-.375*i-.125*s)/.375;M=(p-.125*n-.375*v-.125*o)/.375;return"M"+h+","+n+"C"+e+","+v+" "+i+","+M+" "+s+","+o},getCirclePath:function(a,t,r){var h=MWFRaphael.getArcPath(a,t,r);var n=Raphael.transformPath(h,"R-90,"+a+","+t);var e=Raphael.transformPath(n,"R-90,"+a+","+t);var v=Raphael.transformPath(e,"R-90,"+a+","+t);var i=h+n[1]+e[1]+v[1]+"z";return i},diamond:function(a,t,r,h,n,e){var v=MWFRaphael.getDiamondPath(a,t,r,h,n,e);return this.path(v)},getDiamondPath:function(a,t,r,h,n,e){var v={x:a,y:t+h/2};var i={x:a+r/2,y:t};var M={x:a+r,y:t+h/2};var s={x:a+r/2,y:t+h};var o=MWFRaphael.getMinus(r/2,h/2,n);var l=MWFRaphael.getMinus(r/2,h/2,e);var x={x:v.x+o.x,y:v.y+o.y};var p={x:s.x-l.x,y:s.y-l.y};var y={x:s.x+l.x,y:s.y-l.y};var P={x:M.x-o.x,y:M.y+o.y};var c={x:M.x-o.x,y:M.y-o.y};var u={x:i.x+l.x,y:i.y+l.y};var f={x:i.x-l.x,y:i.y+l.y};var R={x:v.x+o.x,y:v.y-o.y};path="M"+R.x+","+R.y;path+="Q"+v.x+","+v.y+","+x.x+","+x.y;path+="L"+p.x+","+p.y;path+="Q"+s.x+","+s.y+","+y.x+","+y.y;path+="L"+P.x+","+P.y;path+="Q"+M.x+","+M.y+","+c.x+","+c.y;path+="L"+u.x+","+u.y;path+="Q"+i.x+","+i.y+","+f.x+","+f.y;path+="Z";return path},getMinus:function(a,t,r){var h=Math.sqrt(a*a+t*t);var n=t/(h/90);var e=r/90*n;var v=Math.sqrt(r*r-e*e);return{x:v,y:e}},getPointDistance:function(a,t){var r=Math.abs(a.x-t.x);var h=Math.abs(a.y-t.y);return Math.sqrt(r*r+h*h)},getAngles:function(a,t,r){var h=(t*t+r*r-a*a)/(2*t*r);var n=(a*a+r*r-t*t)/(2*a*r);var e=(a*a+t*t-r*r)/(2*a*t);var v=Math.acos(h);var i=Math.acos(n);var M=Math.acos(e);return{A:v,B:i,C:M}},getMinDistance:function(a,t,r){var h=this.getPointDistance(a,t);var n=this.getPointDistance(a,r);var e=this.getPointDistance(t,r);var v=this.getAngles(h,n,e);var i=v.A;var M=v.B;var s=v.C;var o=h*Math.sin(M);var l=Math.sqrt(h*h-o*o);var x=r.x-t.x;var p=r.y-t.y;var y=p*(1/e);var P=y*l;var c=x*(1/e);var u=c*l;return{h:o,p:{x:t.x+u,y:t.y+P}}},arrow:function(a,t,r,h,n){var e=MWFRaphael.getArrowPath(a,t,r,h,n);return this.path(e)},getArrowPath:function(a,t,r,h,n){var e=t.x;var v=t.y;var i=a.x;var M=a.y;var s=e-i;var o=v-M;if(s==0&&o==0){return""}var l=o/Math.sqrt(s*s+o*o)*r;var x=s/Math.sqrt(s*s+o*o)*r;var p=Math.asin(o/Math.sqrt(s*s+o*o))/Math.PI*180;var y=Math.asin(s/Math.sqrt(s*s+o*o))/Math.PI*180;if(s<=0&o<=0){var P=Math.sin((270-(p-n))*(Math.PI/180))*h;var c=Math.sin((p-n)*(Math.PI/180))*h;var u=Math.sin((270-(y-n))*(Math.PI/180))*h;var f=Math.sin((y-n)*(Math.PI/180))*h}else if(s>0&o<0){var P=Math.sin((90-(p+n))*(Math.PI/180))*h;var c=Math.sin((p+n)*(Math.PI/180))*h;var u=Math.sin((p-n)*(Math.PI/180))*h;var f=Math.sin((y-n)*(Math.PI/180))*h}else if(s<0&o>0){var P=Math.sin((y+n)*(Math.PI/180))*h;var c=Math.sin((p+n)*(Math.PI/180))*h;var u=Math.sin((90-(y-n))*(Math.PI/180))*h;var f=Math.sin((y-n)*(Math.PI/180))*h}else{var P=Math.sin((90-(p-n))*(Math.PI/180))*h;var c=Math.sin((p-n)*(Math.PI/180))*h;var u=Math.sin((90-(y-n))*(Math.PI/180))*h;var f=Math.sin((y-n)*(Math.PI/180))*h}x=s-x+i;l=o-l+M;P=s-P+i;c=o-c+M;f=s-f+i;u=o-u+M;return"M"+x+","+l+"L"+P+","+c+"L"+e+","+v+"L"+f+","+u+"Z"}};