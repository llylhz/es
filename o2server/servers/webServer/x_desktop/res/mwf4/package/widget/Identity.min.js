MWF.widget=MWF.widget||{};MWF.require("MWF.widget.Common",null,false);MWF.widget.Identity=new Class({Implements:[Options,Events],Extends:MWF.widget.Common,options:{style:"default"},initialize:function(t,e,i,n,s,o){this.setOptions(o);this.path=MWF.defaultPath+"/widget/$Identity/";this.cssPath=MWF.defaultPath+"/widget/$Identity/"+this.options.style+"/css.wcss";this._loadCss();this.container=$(e);this.data=t;this.style=this.css;this.explorer=i;this.canRemove=n||false;this.removeAction=s;this.load()},load:function(){this.node=new Element("div",{styles:this.style.identityNode,text:this.data.name}).inject(this.container);if(this.canRemove){this.removeNode=new Element("div",{styles:this.style.identityRemoveNode}).inject(this.node);if(this.removeAction)this.removeNode.addEvent("click",this.removeAction.bind(this))}this.createInforNode(function(){this.fireEvent("loadedInfor")}.bind(this));this.node.addEvents({mouseover:function(){this.node.setStyles(this.style.identityNode_over)}.bind(this),mouseout:function(){this.node.setStyles(this.style.identityNode)}.bind(this)});this.setEvent()},setEvent:function(){},getPerson:function(t){var e="getPersonByIdentity";var i=this.data.name;if(!this.explorer.actions.getPersonByIdentity){e="getPerson";i=this.data.person}this.explorer.actions[e](function(e){if(t)t(e)},null,i)},createInforNode:function(t){this.getPerson(function(e){if(e.data){this.inforNode=new Element("div",{styles:this.style.identityInforNode});var i=new Element("div",{styles:this.style.identityInforNameNode}).inject(this.inforNode);if(e.data.icon){img="<img width='50' height='50' border='0' src='data:image/png;base64,"+e.data.icon+"'></img>"}else{if(e.genderType=="f"){img="<img width='50' height='50' border='0' src='"+"/x_component_Organization/$PersonExplorer/default/icon/female.png'></img>"}else{img="<img width='50' height='50' border='0' src='"+"/x_component_Organization/$PersonExplorer/default/icon/man.png'></img>"}}var n=new Element("div",{styles:this.style.identityInforPicNode,html:img}).inject(i);var s=new Element("div",{styles:this.style.identityInforNameTextNode,text:e.data.display}).inject(i);var o=new Element("div",{styles:this.style.identityInforPhoneNode,html:"<div style='width:30px; float:left'>"+this.explorer.app.lp.phone+": </div><div style='width:90px; float:left; margin-left:10px'>"+(e.data.mobile||"")+"</div>"}).inject(this.inforNode);var d=new Element("div",{styles:this.style.identityInforPhoneNode,html:"<div style='width:30px; float:left'>"+this.explorer.app.lp.mail+": </div><div style='width:90px; float:left; margin-left:10px'>"+(e.data.mail||"")+"</div>"}).inject(this.inforNode);new mBox.Tooltip({content:this.inforNode,setStyles:{content:{padding:15,lineHeight:20}},attach:this.node,transition:"flyin"})}if(t)t()}.bind(this))}});MWF.widget.Person=new Class({Implements:[Options,Events],Extends:MWF.widget.Identity,getPerson:function(t){if(this.data.name&&this.data.id){if(t)t({data:this.data})}else{var e=this.data.name;this.explorer.actions["getPerson"](function(e){if(t)t(e)},null,e)}}});MWF.widget.Department=new Class({Implements:[Options,Events],Extends:MWF.widget.Identity,createInforNode:function(){return true}});MWF.widget.Company=new Class({Extends:MWF.widget.Department});MWF.widget.Application=new Class({Extends:MWF.widget.Department});MWF.widget.Process=new Class({Extends:MWF.widget.Department});MWF.widget.FormField=new Class({Extends:MWF.widget.Department});