MWF.widget=MWF.widget||{};MWF.require("MWF.widget.Common",null,false);MWF.widget.Mask=new Class({Implements:[Options,Events],Extends:MWF.widget.Common,options:{style:"default",zIndex:100,loading:true},initialize:function(t){this.setOptions(t);this.path=MWF.defaultPath+"/widget/$Mask/";this.cssPath=MWF.defaultPath+"/widget/$Mask/"+this.options.style+"/css.wcss";this._loadCss();this._createMaskNodes()},_createMaskNodes:function(){this.container=new Element("div",{styles:this.css.container});this.container.setStyle("z-index",this.options.zIndex);this.maskBar=new Element("iframe",{styles:this.css.mask});this.maskBar.setStyle("z-index",this.options.zIndex);this.backgroundBar=new Element("div",{styles:this.css.backgroundBar});this.backgroundBar.setStyle("z-index",this.options.zIndex+1);this.loadBar=new Element("div",{styles:this.css.loadingBar,html:'<table width="80%" border="0" cellspacing="0" cellpadding="0"><tr valign="middle" height="30"><td align="right"><img src="'+MWF.defaultPath+"/widget/$Mask/"+this.options.style+'/loading.gif" /></td><td align="center">loading...</td></tr></table>'});this.loadBar.setStyle("z-index",this.options.zIndex+2);this.maskBar.inject(this.container);this.backgroundBar.inject(this.container);this.loadBar.inject(this.container)},hide:function(t){var i=new Fx.Morph(this.container,{duration:500});i.start({opacity:0}).chain(function(){this.container.destroy();if(t)t()}.bind(this))},load:function(){if(this.fireEvent("queryLoad")){this.container.inject($(document.body));if(!this.options.loading){this.loadBar.setStyle("display","none")}else{this.loadBar.setStyle("display","block");var t=this.container.getSize();var i=(t.x-120)/2;var e=(t.y-30)/2;if(e<=0)e=(window.screen.height-30)/2;this.loadBar.setStyle("left",""+i+"px");this.loadBar.setStyle("top",""+e+"px")}this.fireEvent("postLoad")}},loadNode:function(t){if(this.fireEvent("queryLoad")){this.container.inject($(t));if(!this.options.loading){this.loadBar.setStyle("display","none")}else{this.loadBar.setStyle("display","block");var i=$(t).getSize();var e=i.x/2;var s=(i.y-30)/2;if(s<=0)s=(window.screen.height-30)/2-100;this.loadBar.setStyle("left",""+e+"px");this.loadBar.setStyle("top",""+s+"px")}this.fireEvent("postLoad")}}});